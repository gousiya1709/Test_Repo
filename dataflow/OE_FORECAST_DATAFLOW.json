{
	"name": "OE_FORECAST_DATAFLOW",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "AzureSqlTable1",
						"type": "DatasetReference"
					},
					"name": "source1"
				},
				{
					"dataset": {
						"referenceName": "AzureSqlTable2",
						"type": "DatasetReference"
					},
					"name": "source2"
				},
				{
					"dataset": {
						"referenceName": "DatasetSnk",
						"type": "DatasetReference"
					},
					"name": "OESource"
				},
				{
					"dataset": {
						"referenceName": "DelimitedText1",
						"type": "DatasetReference"
					},
					"name": "source3"
				}
			],
			"sinks": [
				{
					"dataset": {
						"referenceName": "AzureSqlTable4",
						"type": "DatasetReference"
					},
					"name": "sink1"
				}
			],
			"transformations": [
				{
					"name": "OEUnpivot"
				},
				{
					"name": "DerivedColumn1"
				},
				{
					"name": "Aggregate1"
				},
				{
					"name": "Select1"
				},
				{
					"name": "DerivedColumn2"
				},
				{
					"name": "Filter1"
				},
				{
					"name": "ConditionalSplit1"
				},
				{
					"name": "Select2"
				},
				{
					"name": "DerivedColumn3"
				},
				{
					"name": "Union1"
				},
				{
					"name": "DerivedColumn4"
				},
				{
					"name": "ConditionalSplit2"
				},
				{
					"name": "Select3"
				},
				{
					"name": "DerivedColumn5"
				},
				{
					"name": "Select4"
				},
				{
					"name": "DerivedColumn6"
				},
				{
					"name": "Select5"
				},
				{
					"name": "DerivedColumn7"
				},
				{
					"name": "Union2"
				},
				{
					"name": "DerivedColumn8"
				},
				{
					"name": "Lookup1"
				},
				{
					"name": "DerivedColumn9"
				},
				{
					"name": "ConditionalSplit3"
				},
				{
					"name": "Lookup2"
				},
				{
					"name": "Select8"
				},
				{
					"name": "Union3"
				}
			],
			"script": "source(output(\n\t\tOriginalSize as string,\n\t\tCorrectedSize as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> source1\nsource(output(\n\t\tOriginalSpeedRating as string,\n\t\tNewSpeedRating as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> source2\nsource(output(\n\t\t{SALE COUNTRY} as string,\n\t\tVEH_SOURCE as string,\n\t\t{IMPORT / DOMESTIC} as string,\n\t\t{Mnemonic Only} as string,\n\t\t{Vehicle Sales: Mnemonic - Vehicle/Country or MCODE} as string,\n\t\tTCODE as string,\n\t\t{Vehicle Sales: Sales Parent or GROUP} as string,\n\t\t{Vehicle Sales: Car/Truck or MACRO LEVEL SEGMENT} as string,\n\t\t{Vehicle Sales: Regional Sub-Segment or MODIFIED SEGMENT} as string,\n\t\t{Regional Segment  Concat or DRI SEGMENT} as string,\n\t\t{Vehicle Sales: Platform} as string,\n\t\t{Vehicle Sales: Brand} as string,\n\t\t{Vehicle Sales: Nameplate or MODEL} as string,\n\t\tTRIM as string,\n\t\tElectric as string,\n\t\t{Vehicle Sales: Body Type or BODYSTYLE} as string,\n\t\tDOORS as string,\n\t\tDRIVETYPE as string,\n\t\t{LAST UPDATE} as string,\n\t\tSERIES as string,\n\t\tTYPE_F as string,\n\t\t{SECTION WIDTH} as string,\n\t\t{ASPECT RATIO} as string,\n\t\t{TYPE CONSTRUCTION} as string,\n\t\t{RIM DIAMETER} as string,\n\t\t{LOAD INDEX} as string,\n\t\t{SPEED SYMBOL} as string,\n\t\tFRONT_SIZE as string,\n\t\tCORE_F_SIZE as string,\n\t\t{CHECK INFO F TO B} as string,\n\t\tTYPE_R as string,\n\t\t{REAR SECTION WIDTH} as string,\n\t\t{REAR ASPECT RATIO} as string,\n\t\t{REAR TYPE CONSTRUCTION} as string,\n\t\t{REAR RIM DIAMETER} as string,\n\t\t{REAR LOAD INDEX} as string,\n\t\t{REAR SPEED SYMBOL} as string,\n\t\tREAR_SIZE as string,\n\t\tCORE_R_SIZE as string,\n\t\t{TIRE PARENT} as string,\n\t\tTIRE_BRAND as string,\n\t\tTIRE_MODEL as string,\n\t\t{Tire Category} as string,\n\t\t{Vehicle App} as string,\n\t\tSegment as string,\n\t\t{Reporting Segment} as string,\n\t\t{Tire Designation} as string,\n\t\t{AS / SUM / WIN / LRR  APPLIES TO OEM MARKETING} as string,\n\t\tSIDEWALL as string,\n\t\t{WHEEL TYPE} as string,\n\t\t{RUN_FLAT DETAIL  (INTERNAL TO TIRE)} as string,\n\t\tPRES_MON as string,\n\t\tMON_SUPP as string,\n\t\t{SPARE DETAIL  (EXTERNAL TO TIRE)} as string,\n\t\t{1998_VVOL} as string,\n\t\t{1999_VVOL} as string,\n\t\t{2000_VVOL} as string,\n\t\t{2001_VVOL} as string,\n\t\t{2002_VVOL} as string,\n\t\t{2003_VVOL} as string,\n\t\t{2004_VVOL} as string,\n\t\t{2005_VVOL} as string,\n\t\t{2006_VVOL} as string,\n\t\t{2007_VVOL} as string,\n\t\t{2008_VVOL} as string,\n\t\t{2009_VVOL} as string,\n\t\t{2010_VVOL} as string,\n\t\t{2011_VVOL} as string,\n\t\t{2012_VVOL} as string,\n\t\t{2013_VVOL} as string,\n\t\t{2014_VVOL} as string,\n\t\t{2015_VVOL} as string,\n\t\t{2016_VVOL} as string,\n\t\t{2017_VVOL} as string,\n\t\t{2018_VVOL} as string,\n\t\t{2019_VVOL} as string,\n\t\t{2020_VVOL} as string,\n\t\t{2021_VVOL} as string,\n\t\t{2022_VVOL} as string,\n\t\t{2023_VVOL} as string,\n\t\t{2024_VVOL} as string,\n\t\t{2025_VVOL} as string,\n\t\t{1998_TVOL} as string,\n\t\t{1999_TVOL} as string,\n\t\t{2000_TVOL} as string,\n\t\t{2001_TVOL} as string,\n\t\t{2002_TVOL} as string,\n\t\t{2003_TVOL} as string,\n\t\t{2004_TVOL} as string,\n\t\t{2005_TVOL} as string,\n\t\t{2006_TVOL} as string,\n\t\t{2007_TVOL} as string,\n\t\t{2008_TVOL} as string,\n\t\t{2009_TVOL} as string,\n\t\t{2010_TVOL} as string,\n\t\t{2011_TVOL} as string,\n\t\t{2012_TVOL} as string,\n\t\t{2013_TVOL} as string,\n\t\t{2014_TVOL} as string,\n\t\t{2015_TVOL} as string,\n\t\t{2016_TVOL} as string,\n\t\t{2017_TVOL} as string,\n\t\t{2018_TVOL} as string,\n\t\t{2019_TVOL} as string,\n\t\t{2020_TVOL} as string,\n\t\t{2021_TVOL} as string,\n\t\t{2022_TVOL} as string,\n\t\t{2023_TVOL} as string,\n\t\t{2024_TVOL} as string,\n\t\t{2025_TVOL} as string,\n\t\t{Updated Segment} as string,\n\t\t{Updated Bodytype} as string,\n\t\t{Vehicle Sales: Regional Segment} as string,\n\t\t{Vehicle Sales: Regional Price Class} as string,\n\t\t{Global Sales Segment} as string,\n\t\t{Global Sales Sub-segment} as string,\n\t\t{Global Sales Price Class} as string,\n\t\t{Vehicle Sales: Program} as string,\n\t\t{RUN_FLAT SIMPL} as string,\n\t\t{SPARE TIRE SIMPL} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> OESource\nsource(output(\n\t\t{Vehicle Sale Country} as string,\n\t\t{Vehicle Source Country} as string,\n\t\t{Vehicle Source Classification} as string,\n\t\t{Markit code} as string,\n\t\tMCODE as string,\n\t\tTCODE as string,\n\t\t{Vehicle Sales Parent} as string,\n\t\t{Vehicle Macro Segment} as string,\n\t\t{Vehicle Sub-segment} as string,\n\t\t{Vehicle Micro Segment} as string,\n\t\t{Vehicle Platform} as string,\n\t\t{Vehicle Brand} as string,\n\t\t{Vehicle Model} as string,\n\t\t{Vehicle Trim} as string,\n\t\t{Vehicle Electric Indicator} as string,\n\t\t{Vehicle Body Style} as string,\n\t\t{Vehicle Number of Doors} as string,\n\t\t{Vehicle Drive Type} as string,\n\t\t{Vehicle Last Update} as string,\n\t\t{Vehicle Series} as string,\n\t\t{Tire Prefix} as string,\n\t\t{Tire Section Width} as string,\n\t\t{Tire Aspect Ratio} as string,\n\t\t{Tire Construction} as string,\n\t\t{Tire Rim Diameter} as string,\n\t\t{Tire Load Index} as string,\n\t\t{Tire Speed Rating} as string,\n\t\t{Tire Total Size} as string,\n\t\t{Tire Size} as string,\n\t\t{Front vs Rear Tire Different} as string,\n\t\t{Tire Parent} as string,\n\t\t{Tire Brand} as string,\n\t\t{Tire Model} as string,\n\t\t{RMA Tire Category} as string,\n\t\t{RMA Vehicle App} as string,\n\t\t{RMA Segment} as string,\n\t\t{Reporting Segment} as string,\n\t\t{Tire Designation} as string,\n\t\t{Tire Application} as string,\n\t\t{Tire Sidewall} as string,\n\t\t{Wheel Type} as string,\n\t\t{Tire Run Flat Technology} as string,\n\t\t{Tire Pressure Monitoring} as string,\n\t\t{Supplier of Tire Pressure Monitoring} as string,\n\t\t{Spare Detail} as string,\n\t\t{Vehicle Updated Segment} as string,\n\t\t{Vehicle Updated Bodytype} as string,\n\t\t{Vehicle Regional Segment} as string,\n\t\t{Vehicle Regional Price Class} as string,\n\t\t{Vehicle Global Segment} as string,\n\t\t{Vehicle Global Subsegment} as string,\n\t\t{Vehicle Global Price Class} as string,\n\t\t{Vehicle Program} as string,\n\t\t{Simple Run Flat Detail} as string,\n\t\t{Simple Spare Detail} as string,\n\t\t{Vehicle Model Year} as string,\n\t\t{Tire Volume} as string,\n\t\t{Vehicle Sales Volume} as string,\n\t\t{Tire Position} as string,\n\t\t{Timestamp of Data} as string,\n\t\t{Timestamp Timezone} as string,\n\t\t{Tire Load Range} as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> source3\nOESource unpivot(output(\n\t\tName as string,\n\t\tValue as double\n\t),\n\tungroupBy({SALE COUNTRY},\n\t\tVEH_SOURCE,\n\t\t{IMPORT / DOMESTIC},\n\t\t{Mnemonic Only},\n\t\t{Vehicle Sales: Mnemonic - Vehicle/Country or MCODE},\n\t\tTCODE,\n\t\t{Vehicle Sales: Sales Parent or GROUP},\n\t\t{Vehicle Sales: Car/Truck or MACRO LEVEL SEGMENT},\n\t\t{Vehicle Sales: Regional Sub-Segment or MODIFIED SEGMENT},\n\t\t{Regional Segment  Concat or DRI SEGMENT},\n\t\t{Vehicle Sales: Platform},\n\t\t{Vehicle Sales: Brand},\n\t\t{Vehicle Sales: Nameplate or MODEL},\n\t\tTRIM,\n\t\tElectric,\n\t\t{Vehicle Sales: Body Type or BODYSTYLE},\n\t\tDOORS,\n\t\tDRIVETYPE,\n\t\t{LAST UPDATE},\n\t\tSERIES,\n\t\tTYPE_F,\n\t\t{SECTION WIDTH},\n\t\t{ASPECT RATIO},\n\t\t{TYPE CONSTRUCTION},\n\t\t{RIM DIAMETER},\n\t\t{LOAD INDEX},\n\t\t{SPEED SYMBOL},\n\t\tFRONT_SIZE,\n\t\tCORE_F_SIZE,\n\t\t{CHECK INFO F TO B},\n\t\tTYPE_R,\n\t\t{REAR SECTION WIDTH},\n\t\t{REAR ASPECT RATIO},\n\t\t{REAR TYPE CONSTRUCTION},\n\t\t{REAR RIM DIAMETER},\n\t\t{REAR LOAD INDEX},\n\t\t{REAR SPEED SYMBOL},\n\t\tREAR_SIZE,\n\t\tCORE_R_SIZE,\n\t\t{TIRE PARENT},\n\t\tTIRE_BRAND,\n\t\tTIRE_MODEL,\n\t\t{Tire Category},\n\t\t{Vehicle App},\n\t\tSegment,\n\t\t{Reporting Segment},\n\t\t{Tire Designation},\n\t\t{AS / SUM / WIN / LRR  APPLIES TO OEM MARKETING},\n\t\tSIDEWALL,\n\t\t{WHEEL TYPE},\n\t\t{RUN_FLAT DETAIL  (INTERNAL TO TIRE)},\n\t\tPRES_MON,\n\t\tMON_SUPP,\n\t\t{SPARE DETAIL  (EXTERNAL TO TIRE)},\n\t\t{Updated Segment},\n\t\t{Updated Bodytype},\n\t\t{Vehicle Sales: Regional Segment},\n\t\t{Vehicle Sales: Regional Price Class},\n\t\t{Global Sales Segment},\n\t\t{Global Sales Sub-segment},\n\t\t{Global Sales Price Class},\n\t\t{Vehicle Sales: Program},\n\t\t{RUN_FLAT SIMPL},\n\t\t{SPARE TIRE SIMPL}),\n\tlateral: true,\n\tignoreNullPivots: false) ~> OEUnpivot\nOEUnpivot derive({Vehicle Model Year} = left(Name, 4),\n\t\tValue = iif(toString(toInteger(Value))=='x',0,toInteger(Value)),\n\t\t{Tire Volume} = iif(upper(substring(Name,6,4))=='TVOL',toInteger(Value),0),\n\t\t{Vehicle Sales Volume} = iif(upper(substring(Name,6,4))=='VVOL',toInteger(Value),0),\n\t\t{Volume Type} = upper(substring(Name,6,4)),\n\t\t{Volume Type} := upper(substring(Name, 5, 4))) ~> DerivedColumn1\nDerivedColumn1 aggregate(groupBy({SALE COUNTRY},\n\t\tVEH_SOURCE,\n\t\t{IMPORT / DOMESTIC},\n\t\t{Mnemonic Only},\n\t\t{Vehicle Sales: Mnemonic - Vehicle/Country or MCODE},\n\t\tTCODE,\n\t\t{Vehicle Sales: Sales Parent or GROUP},\n\t\t{Vehicle Sales: Car/Truck or MACRO LEVEL SEGMENT},\n\t\t{Vehicle Sales: Regional Sub-Segment or MODIFIED SEGMENT},\n\t\t{Regional Segment  Concat or DRI SEGMENT},\n\t\t{Vehicle Sales: Platform},\n\t\t{Vehicle Sales: Brand},\n\t\t{Vehicle Sales: Nameplate or MODEL},\n\t\tTRIM,\n\t\tElectric,\n\t\t{Vehicle Sales: Body Type or BODYSTYLE},\n\t\tDOORS,\n\t\tDRIVETYPE,\n\t\t{LAST UPDATE},\n\t\tSERIES,\n\t\tTYPE_F,\n\t\t{SECTION WIDTH},\n\t\t{ASPECT RATIO},\n\t\t{TYPE CONSTRUCTION},\n\t\t{RIM DIAMETER},\n\t\t{LOAD INDEX},\n\t\t{SPEED SYMBOL},\n\t\tFRONT_SIZE,\n\t\tCORE_F_SIZE,\n\t\t{CHECK INFO F TO B},\n\t\tTYPE_R,\n\t\t{REAR SECTION WIDTH},\n\t\t{REAR ASPECT RATIO},\n\t\t{REAR TYPE CONSTRUCTION},\n\t\t{REAR RIM DIAMETER},\n\t\t{REAR LOAD INDEX},\n\t\t{REAR SPEED SYMBOL},\n\t\tREAR_SIZE,\n\t\tCORE_R_SIZE,\n\t\t{TIRE PARENT},\n\t\tTIRE_BRAND,\n\t\tTIRE_MODEL,\n\t\t{Tire Category},\n\t\t{Vehicle App},\n\t\tSegment,\n\t\t{Reporting Segment},\n\t\t{Tire Designation},\n\t\t{AS / SUM / WIN / LRR  APPLIES TO OEM MARKETING},\n\t\tSIDEWALL,\n\t\t{WHEEL TYPE},\n\t\t{RUN_FLAT DETAIL  (INTERNAL TO TIRE)},\n\t\tPRES_MON,\n\t\tMON_SUPP,\n\t\t{SPARE DETAIL  (EXTERNAL TO TIRE)},\n\t\t{Updated Segment},\n\t\t{Updated Bodytype},\n\t\t{Vehicle Sales: Regional Segment},\n\t\t{Vehicle Sales: Regional Price Class},\n\t\t{Global Sales Segment},\n\t\t{Global Sales Sub-segment},\n\t\t{Global Sales Price Class},\n\t\t{Vehicle Sales: Program},\n\t\t{RUN_FLAT SIMPL},\n\t\t{SPARE TIRE SIMPL},\n\t\t{Vehicle Model Year}),\n\t{Tire Volume} = toString(sum({Tire Volume})),\n\t\t{Vehicle Sales Volume} = sum({Vehicle Sales Volume})) ~> Aggregate1\nAggregate1 select(mapColumn(\n\t\t{Vehicle Sale Country\t} = {SALE COUNTRY},\n\t\t{Vehicle Source Country} = VEH_SOURCE,\n\t\t{Vehicle Source Classification} = {IMPORT / DOMESTIC},\n\t\t{Markit code} = {Mnemonic Only},\n\t\tMCODE = {Vehicle Sales: Mnemonic - Vehicle/Country or MCODE},\n\t\tTCODE,\n\t\t{Vehicle Sales Parent} = {Vehicle Sales: Sales Parent or GROUP},\n\t\t{Vehicle Macro Segment} = {Vehicle Sales: Car/Truck or MACRO LEVEL SEGMENT},\n\t\t{Vehicle Sub-segment} = {Vehicle Sales: Regional Sub-Segment or MODIFIED SEGMENT},\n\t\t{Vehicle Micro Segment} = {Regional Segment  Concat or DRI SEGMENT},\n\t\t{Vehicle Platform} = {Vehicle Sales: Platform},\n\t\t{Vehicle Brand} = {Vehicle Sales: Brand},\n\t\t{Vehicle Model} = {Vehicle Sales: Nameplate or MODEL},\n\t\t{Vehicle Trim} = TRIM,\n\t\t{Vehicle Electric Indicator} = Electric,\n\t\t{Vehicle Body Style} = {Vehicle Sales: Body Type or BODYSTYLE},\n\t\t{Vehicle Number of Doors} = DOORS,\n\t\t{Vehicle Drive Type} = DRIVETYPE,\n\t\t{Vehicle Last Update} = {LAST UPDATE},\n\t\t{Vehicle Series} = SERIES,\n\t\t{Front Tire Prefix} = TYPE_F,\n\t\t{Front Tire Section Width} = {SECTION WIDTH},\n\t\t{Front Tire Aspect Ratio} = {ASPECT RATIO},\n\t\t{Front Tire Construction} = {TYPE CONSTRUCTION},\n\t\t{Front Tire Rim Diameter} = {RIM DIAMETER},\n\t\t{Front Tire Load Index} = {LOAD INDEX},\n\t\t{Front Tire Speed Rating} = {SPEED SYMBOL},\n\t\t{Total Front Size} = FRONT_SIZE,\n\t\t{Front Size} = CORE_F_SIZE,\n\t\t{Front vs Rear Tire Different} = {CHECK INFO F TO B},\n\t\t{Rear Tire Prefix} = TYPE_R,\n\t\t{Rear Tire Section Width} = {REAR SECTION WIDTH},\n\t\t{Rear Tire Aspect Ratio} = {REAR ASPECT RATIO},\n\t\t{Rear Tire Construction} = {REAR TYPE CONSTRUCTION},\n\t\t{Rear Tire Rim Diameter} = {REAR RIM DIAMETER},\n\t\t{Rear Load Index} = {REAR LOAD INDEX},\n\t\t{Rear Speed Rating} = {REAR SPEED SYMBOL},\n\t\t{Total Rear Size} = REAR_SIZE,\n\t\t{Rear Size} = CORE_R_SIZE,\n\t\t{Tire Parent} = {TIRE PARENT},\n\t\t{Tire Brand} = TIRE_BRAND,\n\t\t{Tire Model} = TIRE_MODEL,\n\t\t{RMA Tire Category} = {Tire Category},\n\t\t{RMA Vehicle App} = {Vehicle App},\n\t\t{RMA Segment} = Segment,\n\t\t{Reporting Segment},\n\t\t{Tire Designation},\n\t\t{Tire Application} = {AS / SUM / WIN / LRR  APPLIES TO OEM MARKETING},\n\t\t{Tire Sidewall} = SIDEWALL,\n\t\t{Wheel Type} = {WHEEL TYPE},\n\t\t{Tire Run Flat Technology} = {RUN_FLAT DETAIL  (INTERNAL TO TIRE)},\n\t\t{Tire Pressure Monitoring} = PRES_MON,\n\t\t{Supplier of Tire Pressure Monitoring} = MON_SUPP,\n\t\t{Spare Detail} = {SPARE DETAIL  (EXTERNAL TO TIRE)},\n\t\t{Vehicle Updated Segment} = {Updated Segment},\n\t\t{Vehicle Updated Bodytype} = {Updated Bodytype},\n\t\t{Vehicle Regional Segment} = {Vehicle Sales: Regional Segment},\n\t\t{Vehicle Regional Price Class} = {Vehicle Sales: Regional Price Class},\n\t\t{Vehicle Global Segment} = {Global Sales Segment},\n\t\t{Vehicle Global Subsegment} = {Global Sales Sub-segment},\n\t\t{Vehicle Global Price Class} = {Global Sales Price Class},\n\t\t{Vehicle Program} = {Vehicle Sales: Program},\n\t\t{Simple Run Flat Detail} = {RUN_FLAT SIMPL},\n\t\t{Simple Spare Detail} = {SPARE TIRE SIMPL},\n\t\t{Vehicle Model Year},\n\t\t{Tire Volume},\n\t\t{Vehicle Sales Volume}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select1\nSelect1 derive({Tire Designation} = case({Tire Designation}=='Light Truck','LT',{Tire Designation}=='Passenger Car','PCR',{Tire Designation})) ~> DerivedColumn2\nDerivedColumn2 filter(and(notEquals(toInteger({Tire Volume}), 0), notEquals({Vehicle Sales Volume}, 0))) ~> Filter1\nFilter1 split(equals({Simple Spare Detail},'Full'),\n\tequals({Simple Spare Detail},'Full'),\n\tdisjoint: false) ~> ConditionalSplit1@(Stream1, Stream2, Stream3)\nConditionalSplit1@Stream1 select(mapColumn(\n\t\t{Vehicle Sale Country\t},\n\t\t{Vehicle Source Country},\n\t\t{Vehicle Source Classification},\n\t\t{Markit code},\n\t\tMCODE,\n\t\tTCODE,\n\t\t{Vehicle Sales Parent},\n\t\t{Vehicle Macro Segment},\n\t\t{Vehicle Sub-segment},\n\t\t{Vehicle Micro Segment},\n\t\t{Vehicle Platform},\n\t\t{Vehicle Brand},\n\t\t{Vehicle Model},\n\t\t{Vehicle Trim},\n\t\t{Vehicle Electric Indicator},\n\t\t{Vehicle Body Style},\n\t\t{Vehicle Number of Doors},\n\t\t{Vehicle Drive Type},\n\t\t{Vehicle Last Update},\n\t\t{Vehicle Series},\n\t\t{Tire Prefix} = {Front Tire Prefix},\n\t\t{Tire Section Width} = {Front Tire Section Width},\n\t\t{Tire Aspect Ratio} = {Front Tire Aspect Ratio},\n\t\t{Tire Construction} = {Front Tire Construction},\n\t\t{Tire Rim Diameter} = {Front Tire Rim Diameter},\n\t\t{Tire Load Index} = {Front Tire Load Index},\n\t\t{Tire Speed Rating} = {Front Tire Speed Rating},\n\t\t{Tire Total Size} = {Total Front Size},\n\t\t{Tire Size} = {Front Size},\n\t\t{Front vs Rear Tire Different},\n\t\t{Tire Parent},\n\t\t{Tire Brand},\n\t\t{Tire Model},\n\t\t{RMA Tire Category},\n\t\t{RMA Vehicle App},\n\t\t{RMA Segment},\n\t\t{Reporting Segment},\n\t\t{Tire Designation},\n\t\t{Tire Application},\n\t\t{Tire Sidewall},\n\t\t{Wheel Type},\n\t\t{Tire Run Flat Technology},\n\t\t{Tire Pressure Monitoring},\n\t\t{Supplier of Tire Pressure Monitoring},\n\t\t{Spare Detail},\n\t\t{Vehicle Updated Segment},\n\t\t{Vehicle Updated Bodytype},\n\t\t{Vehicle Regional Segment},\n\t\t{Vehicle Regional Price Class},\n\t\t{Vehicle Global Segment},\n\t\t{Vehicle Global Subsegment},\n\t\t{Vehicle Global Price Class},\n\t\t{Vehicle Program},\n\t\t{Simple Run Flat Detail},\n\t\t{Simple Spare Detail},\n\t\t{Vehicle Model Year},\n\t\t{Tire Volume},\n\t\t{Vehicle Sales Volume}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select2\nConditionalSplit1@Stream2 derive({Tire Volume} = {Tire Volume}-{Vehicle Sales Volume}) ~> DerivedColumn3\nDerivedColumn3, ConditionalSplit1@Stream3 union(byName: true)~> Union1\nSelect2 derive({Tire Volume} = {Vehicle Sales Volume},\n\t\t{Vehicle Sales Volume} = 0,\n\t\t{Tire Position} = 'Full Spare') ~> DerivedColumn4\nUnion1 split(equals({Front vs Rear Tire Different}, 'Y'),\n\tequals({Front vs Rear Tire Different}, 'Y'),\n\tdisjoint: false) ~> ConditionalSplit2@(StreamA, StramB, StreamC)\nConditionalSplit2@StreamA select(mapColumn(\n\t\t{Vehicle Sale Country\t},\n\t\t{Vehicle Source Country},\n\t\t{Vehicle Source Classification},\n\t\t{Markit code},\n\t\tMCODE,\n\t\tTCODE,\n\t\t{Vehicle Sales Parent},\n\t\t{Vehicle Macro Segment},\n\t\t{Vehicle Sub-segment},\n\t\t{Vehicle Micro Segment},\n\t\t{Vehicle Platform},\n\t\t{Vehicle Brand},\n\t\t{Vehicle Model},\n\t\t{Vehicle Trim},\n\t\t{Vehicle Electric Indicator},\n\t\t{Vehicle Body Style},\n\t\t{Vehicle Number of Doors},\n\t\t{Vehicle Drive Type},\n\t\t{Vehicle Last Update},\n\t\t{Vehicle Series},\n\t\t{Tire Prefix} = {Front Tire Prefix},\n\t\t{Tire Section Width} = {Front Tire Section Width},\n\t\t{Tire Aspect Ratio} = {Front Tire Aspect Ratio},\n\t\t{Tire Construction} = {Front Tire Construction},\n\t\t{Tire Rim Diameter} = {Front Tire Rim Diameter},\n\t\t{Tire Load Index} = {Front Tire Load Index},\n\t\t{Tire Speed Rating} = {Front Tire Speed Rating},\n\t\t{Tire Total Size} = {Total Front Size},\n\t\t{Tire Size} = {Front Size},\n\t\t{Front vs Rear Tire Different},\n\t\t{Tire Parent},\n\t\t{Tire Brand},\n\t\t{Tire Model},\n\t\t{RMA Tire Category},\n\t\t{RMA Vehicle App},\n\t\t{RMA Segment},\n\t\t{Reporting Segment},\n\t\t{Tire Designation},\n\t\t{Tire Application},\n\t\t{Tire Sidewall},\n\t\t{Wheel Type},\n\t\t{Tire Run Flat Technology},\n\t\t{Tire Pressure Monitoring},\n\t\t{Supplier of Tire Pressure Monitoring},\n\t\t{Spare Detail},\n\t\t{Vehicle Updated Segment},\n\t\t{Vehicle Updated Bodytype},\n\t\t{Vehicle Regional Segment},\n\t\t{Vehicle Regional Price Class},\n\t\t{Vehicle Global Segment},\n\t\t{Vehicle Global Subsegment},\n\t\t{Vehicle Global Price Class},\n\t\t{Vehicle Program},\n\t\t{Simple Run Flat Detail},\n\t\t{Simple Spare Detail},\n\t\t{Vehicle Model Year},\n\t\t{Tire Volume},\n\t\t{Vehicle Sales Volume}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select3\nSelect3 derive({Tire Volume} = multiply({Vehicle Sales Volume},2),\n\t\t{Vehicle Sales Volume} = divide({Vehicle Sales Volume}, 2),\n\t\t{Tire Position} = 'Front') ~> DerivedColumn5\nConditionalSplit2@StramB select(mapColumn(\n\t\t{Vehicle Sale Country\t},\n\t\t{Vehicle Source Country},\n\t\t{Vehicle Source Classification},\n\t\t{Markit code},\n\t\tMCODE,\n\t\tTCODE,\n\t\t{Vehicle Sales Parent},\n\t\t{Vehicle Macro Segment},\n\t\t{Vehicle Sub-segment},\n\t\t{Vehicle Micro Segment},\n\t\t{Vehicle Platform},\n\t\t{Vehicle Brand},\n\t\t{Vehicle Model},\n\t\t{Vehicle Trim},\n\t\t{Vehicle Electric Indicator},\n\t\t{Vehicle Body Style},\n\t\t{Vehicle Number of Doors},\n\t\t{Vehicle Drive Type},\n\t\t{Vehicle Last Update},\n\t\t{Vehicle Series},\n\t\t{Front vs Rear Tire Different},\n\t\t{Tire Prefix} = {Rear Tire Prefix},\n\t\t{Tire Section Width} = {Rear Tire Section Width},\n\t\t{Tire Aspect Ratio} = {Rear Tire Aspect Ratio},\n\t\t{Tire Construction} = {Rear Tire Construction},\n\t\t{Tire Rim Diameter} = {Rear Tire Rim Diameter},\n\t\t{Tire Load Index} = {Rear Load Index},\n\t\t{Tire Speed Rating} = {Rear Speed Rating},\n\t\t{Tire Total Size} = {Total Rear Size},\n\t\t{Tire Size} = {Rear Size},\n\t\t{Tire Parent},\n\t\t{Tire Brand},\n\t\t{Tire Model},\n\t\t{RMA Tire Category},\n\t\t{RMA Vehicle App},\n\t\t{RMA Segment},\n\t\t{Reporting Segment},\n\t\t{Tire Designation},\n\t\t{Tire Application},\n\t\t{Tire Sidewall},\n\t\t{Wheel Type},\n\t\t{Tire Run Flat Technology},\n\t\t{Tire Pressure Monitoring},\n\t\t{Supplier of Tire Pressure Monitoring},\n\t\t{Spare Detail},\n\t\t{Vehicle Updated Segment},\n\t\t{Vehicle Updated Bodytype},\n\t\t{Vehicle Regional Segment},\n\t\t{Vehicle Regional Price Class},\n\t\t{Vehicle Global Segment},\n\t\t{Vehicle Global Subsegment},\n\t\t{Vehicle Global Price Class},\n\t\t{Vehicle Program},\n\t\t{Simple Run Flat Detail},\n\t\t{Simple Spare Detail},\n\t\t{Vehicle Model Year},\n\t\t{Tire Volume},\n\t\t{Vehicle Sales Volume}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select4\nSelect4 derive({Tire Volume} = {Tire Volume}-(2*{Vehicle Sales Volume}),\n\t\t{Vehicle Sales Volume} = divide({Vehicle Sales Volume},2),\n\t\t{Tire Position} = 'Rear') ~> DerivedColumn6\nConditionalSplit2@StreamC select(mapColumn(\n\t\t{Vehicle Sale Country\t},\n\t\t{Vehicle Source Country},\n\t\t{Vehicle Source Classification},\n\t\t{Markit code},\n\t\tMCODE,\n\t\tTCODE,\n\t\t{Vehicle Sales Parent},\n\t\t{Vehicle Macro Segment},\n\t\t{Vehicle Sub-segment},\n\t\t{Vehicle Micro Segment},\n\t\t{Vehicle Platform},\n\t\t{Vehicle Brand},\n\t\t{Vehicle Model},\n\t\t{Vehicle Trim},\n\t\t{Vehicle Electric Indicator},\n\t\t{Vehicle Body Style},\n\t\t{Vehicle Number of Doors},\n\t\t{Vehicle Drive Type},\n\t\t{Vehicle Last Update},\n\t\t{Vehicle Series},\n\t\t{Tire Prefix} = {Front Tire Prefix},\n\t\t{Tire Section Width} = {Front Tire Section Width},\n\t\t{Tire Aspect Ratio} = {Front Tire Aspect Ratio},\n\t\t{Tire Construction} = {Front Tire Construction},\n\t\t{Tire Rim Diameter} = {Front Tire Rim Diameter},\n\t\t{Tire Load Index} = {Front Tire Load Index},\n\t\t{Tire Speed Rating} = {Front Tire Speed Rating},\n\t\t{Tire Total Size} = {Total Front Size},\n\t\t{Tire Size} = {Front Size},\n\t\t{Front vs Rear Tire Different},\n\t\t{Tire Parent},\n\t\t{Tire Brand},\n\t\t{Tire Model},\n\t\t{RMA Tire Category},\n\t\t{RMA Vehicle App},\n\t\t{RMA Segment},\n\t\t{Reporting Segment},\n\t\t{Tire Designation},\n\t\t{Tire Application},\n\t\t{Tire Sidewall},\n\t\t{Wheel Type},\n\t\t{Tire Run Flat Technology},\n\t\t{Tire Pressure Monitoring},\n\t\t{Supplier of Tire Pressure Monitoring},\n\t\t{Spare Detail},\n\t\t{Vehicle Updated Segment},\n\t\t{Vehicle Updated Bodytype},\n\t\t{Vehicle Regional Segment},\n\t\t{Vehicle Regional Price Class},\n\t\t{Vehicle Global Segment},\n\t\t{Vehicle Global Subsegment},\n\t\t{Vehicle Global Price Class},\n\t\t{Vehicle Program},\n\t\t{Simple Run Flat Detail},\n\t\t{Simple Spare Detail},\n\t\t{Vehicle Model Year},\n\t\t{Tire Volume},\n\t\t{Vehicle Sales Volume}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select5\nSelect5 derive({Tire Position} = 'Front and Rear') ~> DerivedColumn7\nDerivedColumn5, DerivedColumn6, DerivedColumn7, DerivedColumn4 union(byName: true)~> Union2\nUnion2 derive({Timestamp of Data} = '26-11-2020',\n\t\t{Timestamp TimeZone} = 'EST',\n\t\t{Original Tire Load Index} = rtrim(ltrim({Tire Load Index})),\n\t\t{Tire Load Index} = trim(left(ltrim(rtrim(trim({Tire Load Index}, \"N/K\"))),3)),\n\t\t{Tire Size} = replace(replace({Tire Size}, \" \", \"\"),\"ZR\",\"R\"),\n\t\t{Tire Speed Rating} = iif((in([{Tire Speed Rating}], 'NA') || in([{Tire Speed Rating}], 'N/K') ) && (in([{Tire Prefix}], 'P') || in([{Tire Prefix}], 'LT') || \r\nin([{Tire Prefix}], '')), '0', {Tire Speed Rating}),\n\t\t{RMA Segment} = iif(in([{RMA Segment}], '6')|| in([{RMA Segment}], '7') || in([{RMA Segment}], '8')|| in([{RMA Segment}], '9'),'0'+ {RMA Segment},{RMA Segment})) ~> DerivedColumn8\nDerivedColumn8, source1 lookup({Tire Size} == OriginalSize,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> Lookup1\nLookup2 derive({Tire Size} = coalesce(CorrectedSize,{Tire Size}),\n\t\t{Tire Speed Rating} = coalesce(NewSpeedRating,{Tire Speed Rating}),\n\t\t{Load Range} = case(right({Original Tire Load Index},3)=='STD','STD',right({Original Tire Load Index},2)=='XL','XL',in([right({Original Tire Load Index},1)], 'B')|| in([right({Original Tire Load Index},1)], 'C') || in([right({Original Tire Load Index},1)], 'D')|| in([right({Original Tire Load Index},1)], 'E')|| in([right({Original Tire Load Index},1)], 'F') || in([right({Original Tire Load Index},1)], 'G'),right({Original Tire Load Index},1),'tbd')) ~> DerivedColumn9\nSelect8 split({Tire Load Range}=='tbd',\n\tdisjoint: false) ~> ConditionalSplit3@(StreamT, StreamF)\nLookup1, source2 lookup({Tire Speed Rating} == OriginalSpeedRating,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'auto')~> Lookup2\nDerivedColumn9 select(mapColumn(\n\t\t{Vehicle Sale Country\t},\n\t\t{Vehicle Source Country},\n\t\t{Vehicle Source Classification},\n\t\t{Markit code},\n\t\tMCODE,\n\t\tTCODE,\n\t\t{Vehicle Sales Parent},\n\t\t{Vehicle Macro Segment},\n\t\t{Vehicle Sub-segment},\n\t\t{Vehicle Micro Segment},\n\t\t{Vehicle Platform},\n\t\t{Vehicle Brand},\n\t\t{Vehicle Model},\n\t\t{Vehicle Trim},\n\t\t{Vehicle Electric Indicator},\n\t\t{Vehicle Body Style},\n\t\t{Vehicle Number of Doors},\n\t\t{Vehicle Drive Type},\n\t\t{Vehicle Last Update},\n\t\t{Vehicle Series},\n\t\t{Tire Prefix},\n\t\t{Tire Section Width},\n\t\t{Tire Aspect Ratio},\n\t\t{Tire Construction},\n\t\t{Tire Rim Diameter},\n\t\t{Tire Load Index},\n\t\t{Tire Speed Rating},\n\t\t{Tire Total Size},\n\t\t{Tire Size},\n\t\t{Front vs Rear Tire Different},\n\t\t{Tire Parent},\n\t\t{Tire Brand},\n\t\t{Tire Model},\n\t\t{RMA Tire Category},\n\t\t{RMA Vehicle App},\n\t\t{RMA Segment},\n\t\t{Reporting Segment},\n\t\t{Tire Designation},\n\t\t{Tire Application},\n\t\t{Tire Sidewall},\n\t\t{Wheel Type},\n\t\t{Tire Run Flat Technology},\n\t\t{Tire Pressure Monitoring},\n\t\t{Supplier of Tire Pressure Monitoring},\n\t\t{Spare Detail},\n\t\t{Vehicle Updated Segment},\n\t\t{Vehicle Updated Bodytype},\n\t\t{Vehicle Regional Segment},\n\t\t{Vehicle Regional Price Class},\n\t\t{Vehicle Global Segment},\n\t\t{Vehicle Global Subsegment},\n\t\t{Vehicle Global Price Class},\n\t\t{Vehicle Program},\n\t\t{Simple Run Flat Detail},\n\t\t{Simple Spare Detail},\n\t\t{Vehicle Model Year},\n\t\t{Tire Volume},\n\t\t{Vehicle Sales Volume},\n\t\t{Tire Position},\n\t\t{Timestamp of Data},\n\t\t{Timestamp TimeZone},\n\t\t{Tire Load Range} = {Load Range}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select8\nConditionalSplit3@StreamF, source3 union(byName: true)~> Union3\nUnion3 sink(input(\n\t\tVehicleSaleCountry as string,\n\t\tVehicleSourceCountry as string,\n\t\tVehicleSourceClassification as string,\n\t\tMarkitcode as string,\n\t\tMCODE as string,\n\t\tTCODE as string,\n\t\tVehicleSalesParent as string,\n\t\tVehicleMacroSegment as string,\n\t\tVehicleSubsegment as string,\n\t\tVehicleMicroSegment as string,\n\t\tVehiclePlatform as string,\n\t\tVehicleBrand as string,\n\t\tVehicleModel as string,\n\t\tVehicleTrim as string,\n\t\tVehicleElectricIndicator as string,\n\t\tVehicleBodyStyle as string,\n\t\tVehicleNumberofDoors as string,\n\t\tVehicleDriveType as string,\n\t\tVehicleLastUpdate as string,\n\t\tVehicleSeries as string,\n\t\tTirePrefix as string,\n\t\tTireSectionWidth as string,\n\t\tTireAspectRatio as string,\n\t\tTireConstruction as string,\n\t\tTireRimDiameter as string,\n\t\tTireLoadIndex as string,\n\t\tTireSpeedRating as string,\n\t\tTireTotalSize as string,\n\t\tTireSize as string,\n\t\tFrontvsRearTireDifferent as string,\n\t\tTireParent as string,\n\t\tTireBrand as string,\n\t\tTireModel as string,\n\t\tRMATireCategory as string,\n\t\tRMAVehicleApp as string,\n\t\tRMASegment as string,\n\t\tReportingSegment as string,\n\t\tTireDesignation as string,\n\t\tTireApplication as string,\n\t\tTireSidewall as string,\n\t\tWheelType as string,\n\t\tTireRunFlatTechnology as string,\n\t\tTirePressureMonitoring as string,\n\t\tSupplierofTirePressureMonitoring as string,\n\t\tSpareDetail as string,\n\t\tVehicleUpdatedSegment as string,\n\t\tVehicleUpdatedBodytype as string,\n\t\tVehicleRegionalSegment as string,\n\t\tVehicleRegionalPriceClass as string,\n\t\tVehicleGlobalSegment as string,\n\t\tVehicleGlobalSubsegment as string,\n\t\tVehicleGlobalPriceClass as string,\n\t\tVehicleProgram as string,\n\t\tSimpleRunFlatDetail as string,\n\t\tSimpleSpareDetail as string,\n\t\tVehicleModelYear as string,\n\t\tTireVolume as string,\n\t\tVehicleSalesVolume as string,\n\t\tTirePosition as string,\n\t\tTimestampofData as date,\n\t\tTimestampTimezone as string,\n\t\tTireLoadRange as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tdeletable:false,\n\tinsertable:true,\n\tupdateable:false,\n\tupsertable:false,\n\tformat: 'table',\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true,\n\terrorHandlingOption: 'stopOnFirstError') ~> sink1"
		}
	}
}