{
	"name": "OE_FORECAST_DATAFLOW",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "OE_FORECAST_INPUT",
						"type": "DatasetReference"
					},
					"name": "OEForecast"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "Select"
				},
				{
					"name": "Unpivot1"
				}
			],
			"script": "parameters{\n\tinputfile as string\n}\nsource(allowSchemaDrift: true,\n\tvalidateSchema: false,\n\tignoreNoFilesFound: false) ~> OEForecast\nOEForecast select(mapColumn(\n\t\t{SALE COUNTRY},\n\t\tVEH_SOURCE,\n\t\t{IMPORT / DOMESTIC},\n\t\t{Mnemonic Only},\n\t\t{Vehicle Sales: Mnemonic - Vehicle/Country or MCODE},\n\t\tTCODE,\n\t\t{Vehicle Sales: Sales Parent or GROUP},\n\t\t{Vehicle Sales: Car/Truck or MACRO LEVEL SEGMENT},\n\t\t{Vehicle Sales: Regional Sub-Segment or MODIFIED SEGMENT},\n\t\t{Regional Segment  Concat or DRI SEGMENT},\n\t\t{Vehicle Sales: Platform},\n\t\t{Vehicle Sales: Brand},\n\t\t{Vehicle Sales: Nameplate or MODEL},\n\t\tTRIM,\n\t\tElectric,\n\t\t{Vehicle Sales: Body Type or BODYSTYLE},\n\t\tDOORS,\n\t\tDRIVETYPE,\n\t\t{LAST UPDATE},\n\t\tSERIES,\n\t\tTYPE_F,\n\t\t{SECTION WIDTH},\n\t\t{ASPECT RATIO},\n\t\t{TYPE CONSTRUCTION},\n\t\t{RIM DIAMETER},\n\t\t{LOAD INDEX},\n\t\t{SPEED SYMBOL},\n\t\tFRONT_SIZE,\n\t\tCORE_F_SIZE,\n\t\t{CHECK INFO F TO B},\n\t\tTYPE_R,\n\t\t{REAR SECTION WIDTH},\n\t\t{REAR ASPECT RATIO},\n\t\t{REAR TYPE CONSTRUCTION},\n\t\t{REAR RIM DIAMETER},\n\t\t{REAR LOAD INDEX},\n\t\t{REAR SPEED SYMBOL},\n\t\tREAR_SIZE,\n\t\tCORE_R_SIZE,\n\t\t{TIRE PARENT},\n\t\tTIRE_BRAND,\n\t\tTIRE_MODEL,\n\t\t{Tire Category},\n\t\t{Vehicle App},\n\t\tSegment,\n\t\t{Reporting Segment},\n\t\t{Tire Designation},\n\t\t{AS / SUM / WIN / LRR  APPLIES TO OEM MARKETING},\n\t\tSIDEWALL,\n\t\t{WHEEL TYPE},\n\t\t{RUN_FLAT DETAIL  (INTERNAL TO TIRE)},\n\t\tPRES_MON,\n\t\tMON_SUPP,\n\t\t{SPARE DETAIL  (EXTERNAL TO TIRE)},\n\t\t{1998_VVOL},\n\t\t{1999_VVOL},\n\t\t{2000_VVOL},\n\t\t{2001_VVOL},\n\t\t{2002_VVOL},\n\t\t{2003_VVOL},\n\t\t{2004_VVOL},\n\t\t{2005_VVOL},\n\t\t{2006_VVOL},\n\t\t{2007_VVOL},\n\t\t{2008_VVOL},\n\t\t{2009_VVOL},\n\t\t{2010_VVOL},\n\t\t{2011_VVOL},\n\t\t{2012_VVOL},\n\t\t{2013_VVOL},\n\t\t{2014_VVOL},\n\t\t{2015_VVOL},\n\t\t{2016_VVOL},\n\t\t{2017_VVOL},\n\t\t{2018_VVOL},\n\t\t{2019_VVOL},\n\t\t{2020_VVOL},\n\t\t{2021_VVOL},\n\t\t{2022_VVOL},\n\t\t{2023_VVOL},\n\t\t{2024_VVOL},\n\t\t{2025_VVOL},\n\t\t{1998_TVOL},\n\t\t{1999_TVOL},\n\t\t{2000_TVOL},\n\t\t{2001_TVOL},\n\t\t{2002_TVOL},\n\t\t{2003_TVOL},\n\t\t{2004_TVOL},\n\t\t{2005_TVOL},\n\t\t{2006_TVOL},\n\t\t{2007_TVOL},\n\t\t{2008_TVOL},\n\t\t{2009_TVOL},\n\t\t{2010_TVOL},\n\t\t{2011_TVOL},\n\t\t{2012_TVOL},\n\t\t{2013_TVOL},\n\t\t{2014_TVOL},\n\t\t{2015_TVOL},\n\t\t{2016_TVOL},\n\t\t{2017_TVOL},\n\t\t{2018_TVOL},\n\t\t{2019_TVOL},\n\t\t{2020_TVOL},\n\t\t{2021_TVOL},\n\t\t{2022_TVOL},\n\t\t{2023_TVOL},\n\t\t{2024_TVOL},\n\t\t{2025_TVOL},\n\t\t{Updated Segment},\n\t\t{Updated Bodytype},\n\t\t{Vehicle Sales: Regional Segment},\n\t\t{Vehicle Sales: Regional Price Class},\n\t\t{Global Sales Segment},\n\t\t{Global Sales Sub-segment},\n\t\t{Global Sales Price Class},\n\t\t{Vehicle Sales: Program},\n\t\t{RUN_FLAT SIMPL},\n\t\t{SPARE TIRE SIMPL}\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> Select\nSelect unpivot(output(\n\t\tName as string,\n\t\tValue as integer\n\t),\n\tungroupBy({SALE COUNTRY},\n\t\t{} = ERROR_FUNCTION(''),\n\t\tVEH_SOURCE,\n\t\t{IMPORT / DOMESTIC},\n\t\t{Mnemonic Only},\n\t\t{Vehicle Sales: Mnemonic - Vehicle/Country or MCODE},\n\t\tTCODE,\n\t\t{Vehicle Sales: Sales Parent or GROUP},\n\t\t{Vehicle Sales: Car/Truck or MACRO LEVEL SEGMENT},\n\t\t{Vehicle Sales: Regional Sub-Segment or MODIFIED SEGMENT},\n\t\t{Vehicle Sales: Platform},\n\t\t{Vehicle Sales: Brand},\n\t\t{Vehicle Sales: Nameplate or MODEL},\n\t\tTRIM,\n\t\tElectric,\n\t\t{} = ERROR_FUNCTION('')),\n\tlateral: false,\n\tignoreNullPivots: false) ~> Unpivot1"
		}
	}
}